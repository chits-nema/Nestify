<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nestify - Find Your Forever Home</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="logo"><a href="index.html" style="text-decoration: none; color: inherit;"><h1><i class="fas fa-home"></i> Nestify</h1></a></div>
      <ul class="nav-links">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="index.html?mode=calculator">Budget Calculator</a></li>
        <li><a href="pinterest.html">Pinterest Style</a></li>
      </ul>
    </div>
  </nav>

  <div class="hero">
    <h2>Find Your Forever Home</h2>
    <p>Two ways to discover your perfect property</p>
  </div>

  <!-- Landing Page - Feature Selection -->
  <div class="landing-features" id="landingFeatures">
    <div class="feature-cards">
      <div class="feature-card budget-card">
        <div class="feature-icon"><i class="fas fa-calculator"></i></div>
        <h3>Budget Calculator</h3>
        <p>Calculate your buying power based on income, equity, and expenses. Get realistic property recommendations.</p>
        <ul class="feature-list">
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Instant budget calculation</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Affordability heatmap</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Swipe through properties</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Real-time market data</li>
        </ul>
        <button class="btn primary" onclick="startBudgetCalculator()">
          Start Budgeting ‚Üí
        </button>
      </div>

      <div class="feature-card pinterest-card">
        <div class="feature-icon"><i class="fas fa-palette"></i></div>
        <h3>Pinterest Style Finder</h3>
        <p>Share your Pinterest board and find properties matching your aesthetic preferences and style.</p>
        <ul class="feature-list">
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>AI style analysis</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Match by aesthetics</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Feature detection</li>
          <li><i class="fas fa-check" style="color: #8FA88E; margin-right: 8px;"></i>Personalized results</li>
        </ul>
        <button class="btn primary" onclick="window.location.href='pinterest.html'">
          Find By Style ‚Üí
        </button>
      </div>
    </div>

    <div class="landing-benefits">
      <h3><i class="fas fa-home"></i> Why Choose Nestify?</h3>
      <div class="benefits-grid">
        <div class="benefit-item">
          <span class="benefit-icon"><i class="fas fa-bullseye"></i></span>
          <h4>Accurate Budgeting</h4>
          <p>Know exactly what you can afford with real mortgage calculations</p>
        </div>
        <div class="benefit-item">
          <span class="benefit-icon"><i class="fas fa-map-marked-alt"></i></span>
          <h4>Interactive Maps</h4>
          <p>Visualize affordability with color-coded heatmaps</p>
        </div>
        <div class="benefit-item">
          <span class="benefit-icon"><i class="fas fa-heart"></i></span>
          <h4>Swipe to Save</h4>
          <p>Tinder-style interface to find properties you love</p>
        </div>
        <div class="benefit-item">
          <span class="benefit-icon"><i class="fas fa-robot"></i></span>
          <h4>AI Advisor</h4>
          <p>Chat with our AI for personalized home buying guidance</p>
        </div>
      </div>
    </div>
  </div>

  <div class="main-container" style="display: none;" id="budgetCalculatorApp">
    <!-- Step Indicator -->
    <div class="steps">
      <div class="step active" id="step1"><span class="step-num">1</span> Budget</div>
      <div class="step" id="step2"><span class="step-num">2</span> Results</div>
      <div class="step" id="step3"><span class="step-num">3</span> Explore</div>
      <div class="step" id="step3b"><span class="step-num">3</span> Swipe</div>
    </div>

    <!-- Back to Home Button -->
    <div class="back-to-home">
      <button class="btn secondary btn-small" onclick="backToLanding()">
        ‚Üê Back to Home
      </button>
    </div>

    <!-- STEP 1: Calculator -->
    <div class="section active" id="sec1">
      <div class="calc-panel">
        <h3>üí∞ Calculate Your Budget</h3>
        
        <div class="form-group">
          <label>Monthly Net Household Income</label>
          <div class="input-wrap">
            <input type="number" id="salary" value="5000" min="0" step="100">
            <span class="suffix">‚Ç¨/mo</span>
          </div>
          <div class="input-hint">Combined take-home pay</div>
        </div>
        
        <div class="form-group">
          <label>Available Equity</label>
          <div class="input-wrap">
            <input type="number" id="equity" value="100000" min="0" step="1000">
            <span class="suffix">‚Ç¨</span>
          </div>
          <div class="input-hint">Down payment + savings</div>
        </div>
        
        <div class="form-group">
          <label>Existing Loans (Rate/Leasing)</label>
          <div class="input-wrap">
            <input type="number" id="loans" value="0" min="0" step="50">
            <span class="suffix">‚Ç¨/mo</span>
          </div>
        </div>
        
        <div class="form-group">
          <label>Fixed Repayment Period?</label>
          <div class="radio-row">
            <label><input type="radio" name="fixed" value="no" checked> No</label>
            <label><input type="radio" name="fixed" value="yes"> Yes</label>
          </div>
        </div>
        
        <div class="form-group" id="fixedYearsGroup" style="display: none;">
          <label>Fixed Period (Years)</label>
          <div class="input-wrap">
            <input type="number" id="fixedYears" value="10" min="1" max="30" step="1">
            <span class="suffix">years</span>
          </div>
          <div class="input-hint">Length of fixed interest rate period</div>
        </div>
        
        <div class="form-group">
          <label>Desired Monthly Payment</label>
          <div class="input-wrap">
            <input type="number" id="monthlyRate" value="2000" min="0" step="50">
            <span class="suffix">‚Ç¨/mo</span>
          </div>
        </div>
        
        <div class="form-group">
          <label>Target City</label>
          <select id="city">
            <option value="M√ºnchen">Bayern - M√ºnchen</option>
            <option value="Berlin">Berlin - Berlin</option>
            <option value="Hamburg">Hamburg - Hamburg</option>
            <option value="Frankfurt">Hessen - Frankfurt</option>
            <option value="K√∂ln">Nordrhein-Westfalen - K√∂ln</option>
            <option value="Stuttgart">Baden-W√ºrttemberg - Stuttgart</option>
          </select>
        </div>
        
        <button class="calc-btn" id="calculateBtn">üîç Calculate My Budget</button>
      </div>
    </div>

    <!-- STEP 2: Results -->
    <div class="section" id="sec2">
      <div class="results-grid">
        <!-- Main Result Card -->
        <div class="result-card wide">
          <h4>üè† Your Maximum Property Price</h4>
          <div class="big-num gradient" id="rMaxPrice">‚Ç¨0</div>
          <div class="sub-text">Based on your income, equity, and desired payment</div>
        </div>
        
        <!-- Loan Details -->
        <div class="result-card">
          <h4>üí≥ Loan Details</h4>
          <div class="stat-row"><span class="stat-label">Loan Amount</span><span class="stat-val" id="rLoan">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Interest Rate</span><span class="stat-val" id="rInterest">0%</span></div>
          <div class="stat-row"><span class="stat-label">Effective Rate</span><span class="stat-val" id="rEffective">0%</span></div>
          <div class="stat-row"><span class="stat-label">Monthly Payment</span><span class="stat-val" id="rMonthly">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Amortisation</span><span class="stat-val" id="rAmort">0%</span></div>
          <div class="bank-box">
            <small>Best rate from</small>
            <div class="name" id="rBank">-</div>
          </div>
        </div>
        
        <!-- Duration -->
        <div class="result-card">
          <h4>‚è±Ô∏è Repayment Duration</h4>
          <div class="big-num" id="rYears">0</div>
          <div class="sub-text" id="rDuration">years total</div>
          <div class="dur-bar"><div class="dur-fill" id="durFill"></div></div>
          <div class="dur-labels">
            <span id="rFixed">0 yrs fixed</span>
            <span id="rRemain">0 yrs remaining</span>
          </div>
        </div>
        
        <!-- Total Payments -->
        <div class="result-card">
          <h4>üí∏ Total Payments</h4>
          <div class="stat-row"><span class="stat-label">Total Payment</span><span class="stat-val" id="rTotal">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Total Interest</span><span class="stat-val red" id="rTotalInt">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Remaining after fixed</span><span class="stat-val" id="rRemainDebt">‚Ç¨0</span></div>
        </div>
        
        <!-- Additional Costs -->
        <div class="result-card">
          <h4>üìã Additional Purchase Costs</h4>
          <div class="stat-row"><span class="stat-label">Notary (<span id="pctNotary">0</span>%)</span><span class="stat-val" id="rNotary">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Property Tax (<span id="pctTax">0</span>%)</span><span class="stat-val" id="rTax">‚Ç¨0</span></div>
          <div class="stat-row"><span class="stat-label">Broker (<span id="pctBroker">0</span>%)</span><span class="stat-val" id="rBroker">‚Ç¨0</span></div>
          <div class="stat-row total-row"><span class="stat-label">Total Extra</span><span class="stat-val" id="rExtraTotal">‚Ç¨0</span></div>
          <div class="bar-container">
            <div class="bar-seg notary" id="barNotary"></div>
            <div class="bar-seg tax" id="barTax"></div>
            <div class="bar-seg broker" id="barBroker"></div>
          </div>
          <div class="cost-legend">
            <span><div class="dot notary"></div>Notary</span>
            <span><div class="dot tax"></div>Tax</span>
            <span><div class="dot broker"></div>Broker</span>
          </div>
        </div>
      </div>
      
      <div class="action-btns">
        <button class="btn secondary" onclick="goToStep(1)">‚Üê Adjust</button>
        <button class="btn primary" id="exploreBtn">üó∫Ô∏è View Heatmap</button>
        <button class="btn primary" id="swipeBtn">‚ù§Ô∏è Swipe Properties</button>
      </div>
    </div>

    <!-- STEP 3b: Swipe Mode -->
    <div class="section" id="sec3b">
      <div class="swipe-header">
        <h3>Swipe Your Future Home</h3>
        <p>Properties within your budget of <span id="swipeBudget">‚Ç¨0</span></p>
      </div>
      
      <div class="swipe-container">
        <div id="card-container" class="card-container">
          <p>Loading properties...</p>
        </div>
        
        <div class="swipe-hint">
          <span>üëà Swipe left to pass</span>
          <span>Swipe right to like üëâ</span>
        </div>
        
        <p id="status-text" class="swipe-status"></p>
      </div>
      
      <!-- Liked Properties -->
      <div id="liked-section" class="liked-section" style="display:none;">
        <h4>‚ù§Ô∏è Properties You Liked</h4>
        <div id="liked-container" class="prop-grid"></div>
      </div>
      
      <!-- Recommendations -->
      <div id="recommendations" class="recs-section" style="display:none;">
        <h4>‚ú® Recommended For You</h4>
        <div id="recommendations-container" class="prop-grid"></div>
      </div>
      
      <!-- Detail View Modal -->
      <div id="detail-section" class="detail-section" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:1000; overflow:auto;">
        <div style="max-width:800px; margin:50px auto; background:white; border-radius:12px; padding:30px; position:relative;">
          <button id="detail-close-btn" style="position:absolute; top:20px; right:20px; background:#e74c3c; color:white; border:none; border-radius:50%; width:40px; height:40px; font-size:20px; cursor:pointer;">‚úï</button>
          <img id="detail-image" style="width:100%; border-radius:8px; margin-bottom:20px;" />
          <h2 id="detail-title" style="margin-bottom:10px;"></h2>
          <p id="detail-location" style="color:#666; margin-bottom:15px;"></p>
          <p id="detail-price" style="font-size:24px; font-weight:bold; color:#2ecc71; margin-bottom:10px;"></p>
          <p id="detail-size" style="margin-bottom:5px;"></p>
          <p id="detail-rooms" style="margin-bottom:20px;"></p>
          <a id="detail-link" href="#" target="_blank" style="display:inline-block; padding:12px 24px; background:#3498db; color:white; text-decoration:none; border-radius:8px; font-weight:500;">View Full Listing ‚Üí</a>
        </div>
      </div>
      
      <div class="action-btns">
        <button class="btn secondary" onclick="goToStep(2)">‚Üê Back to Results</button>
        <button class="btn primary" onclick="loadHeatmap()">üó∫Ô∏è View on Map</button>
      </div>
    </div>

    <!-- STEP 3: Heatmap -->
    <div class="section" id="sec3">
      <div class="map-wrap">
        <div id="map"></div>
        <div class="map-stats">
          <div class="map-stat">
            <div class="map-stat-val green" id="cntGreen">0</div>
            <div class="map-stat-lbl">Affordable (‚â§90%)</div>
          </div>
          <div class="map-stat">
            <div class="map-stat-val yellow" id="cntYellow">0</div>
            <div class="map-stat-lbl">Stretch (90-110%)</div>
          </div>
          <div class="map-stat">
            <div class="map-stat-val red" id="cntRed">0</div>
            <div class="map-stat-lbl">Out of Range</div>
          </div>
        </div>
        <div class="map-legend">
          <div class="leg-item"><div class="leg-dot green"></div>Affordable</div>
          <div class="leg-item"><div class="leg-dot yellow"></div>Stretch</div>
          <div class="leg-item"><div class="leg-dot red"></div>Out of Range</div>
        </div>
      </div>
      
      <div class="prop-section">
        <h3>üìç Properties in <span id="cityLabel">M√ºnchen</span></h3>
        <div class="prop-grid" id="propGrid"></div>
      </div>
      
      <div class="action-btns">
        <button class="btn secondary" onclick="goToStep(2)">‚Üê Back to Results</button>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading" id="loading">
    <div class="spinner"></div>
    <p id="loadTxt">Calculating...</p>
  </div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
  <script src="budget.js"></script>
  <script src="tinder.js"></script>
  <script src="chatbot.js"></script>
</body>
</html>